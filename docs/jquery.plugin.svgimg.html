<!DOCTYPE html>  <html> <head>   <title>jquery.plugin.svgimg.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               jquery.plugin.svgimg.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-1">#</a>               </div>               <p>This plugin expects you to supply an SVG or SVGZ file as the
src of an image. The script will only work if you omit the height or 
width from the image in order to detect whether or not it rendered
properly. Usage is simple - for instance to run this method on
any svg images embedded in the page you can use:</p>

<p>$(window).load(function () {
  $("img[src$='.svg'], img[src$='.svgz']").svgimg();
});</p>

<p>I recommend $(window).load() over $(document).ready()
to ensure that supporting browsers were able to render the 
graphic before attempting to replace it with an object.</p>

<p>For handling browsers that do not support SVG graphics
in general - I recommend utilizing a tool such as
Modernizr to detect and handle a lack of SVG support.
See: http://www.modernizr.com/</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">jQuery.fn.svgimg: </span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="o">-&gt;</span>
   </pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-2">#</a>               </div>               <p>Add a load event to each item. Then we perform the basic 
check to ensure it's rendered properly. If not - we'll try
embedding as an object with an alternate image if necessary.</p>             </td>             <td class="code">               <div class="highlight"><pre>   <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span> <span class="o">-&gt;</span>
      <span class="nv">img: </span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
      </pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-3">#</a>               </div>               <p>Add an inline style to prevent display block from breaking
our detection method.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">img</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">,</span><span class="s1">&#39;display: inline-block&#39;</span><span class="p">)</span>
      </pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-4">#</a>               </div>               <p>We're going to return to terminate the handler if we detect both dimensions.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="nx">img</span><span class="p">.</span><span class="nx">height</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
         <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;has_svg_images&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="nx">img</span><span class="p">.</span><span class="nx">width</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
      <span class="k">else</span>
         <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="s1">&#39;has_svg_images&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="nx">img</span><span class="p">.</span><span class="nx">height</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
      
      <span class="k">if</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">).</span><span class="nx">hasClass</span><span class="p">(</span><span class="s1">&#39;has_svg_images&#39;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-5">#</a>               </div>               <p>Remove the inline style.</p>             </td>             <td class="code">               <div class="highlight"><pre>         <span class="nx">img</span><span class="p">.</span><span class="nx">removeAttr</span><span class="p">(</span><span class="s1">&#39;style&#39;</span><span class="p">)</span>
      <span class="k">else</span>
         <span class="nv">object: </span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;object&gt;&#39;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-6">#</a>               </div>               <p>We'll copy over any important attributes from the img tag.</p>             </td>             <td class="code">               <div class="highlight"><pre>         <span class="k">for</span> <span class="nx">attribute</span> <span class="k">in</span> <span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">,</span><span class="s1">&#39;width&#39;</span><span class="p">,</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">]</span>
            <span class="nx">object</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="nx">attribute</span><span class="p">,</span> <span class="nx">img</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="nx">attribute</span><span class="p">))</span> <span class="k">if</span> <span class="nx">img</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="nx">attribute</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="octowrap">                 <a class="octothorpe" href="#section-7">#</a>               </div>               <p>Set the object's data attribute to the image's source.</p>             </td>             <td class="code">               <div class="highlight"><pre>         <span class="nx">object</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="nx">img</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">))</span>
         <span class="nx">img</span><span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="nx">object</span><span class="p">)</span>
         <span class="nx">img</span><span class="p">.</span><span class="nx">remove</span><span class="p">()</span>
   <span class="p">)</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 